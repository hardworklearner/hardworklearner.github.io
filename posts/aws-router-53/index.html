<!doctype html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="AWS Router 53" /><meta name="author" content="Hardwork đẹp trai" /><meta property="og:locale" content="en_US" /><meta name="description" content="Route 53 Section What is DNS Domain Name System which translates the human friendly hostnames into the machine IP address www.google.com =&gt; 172.2.17.18.36 DNS is the backbone of the internet DNS uses hierachical naming structure DNS Terminologies Domain Registrar: Amazon Route 53, GoDaddy, … DNS Records: A, AAAA, CNAME, NS, … Zone file: contains DNS records Name Server: resolves DNS queries (Authoritative or Non- Authoritative) Top Level Domain (TLD): .com, .us, .in, .gov, .org, … Second Level Domain (SLD): amazon.com, google.com, … How DNS works Web browser -&gt; Local DNS Server: Root DNS Server managed by ICANN (res: .com NS 1.2.3.4) TLD DNS Server managed by IANA (res: domain NS 5.6.7.8) SLD DNS Server managed by Domain Registrar (res: domain IP) Amazon Route 53 A highly available, scalable, fully managed and Authoritative DNS Authoritative = the customer (you) can update the DNS records Route 53 is also a Domain Registrar Ability to check the health of your resources The only AWS service which provide 100% availability SLA Why Route 53? 53 is a reference to the traditional DNS port Route53 - Records How you want to route traffic for a domain Each record contains: Domain/subdomain Name: example.com RecordType: e.g A or AAAA Value: 12.34.56.78 Routing Policy: How Route 53 responds to queries TTL: amount of time the record cached at DNS resolvers Route 53 supports the following DNS record types: A / AAAA / CNAME / NS CAA / DS / MX / NAPTR / PTR / SOA / TXT / SPF / SRV Route 53 - Record Types A: maps a hostname to Ipv4 AAAA: maps a hostname to IPv6 CNAME: maps a hostname to another hostname The target is a domain name which must have an A or AAAA record Can’t create a CNAME record for the top node of a DNS namespace (Zone Apex) Exmaple: you can’t create for example.com but you create for www.example.com NS: name Server for the hosted zone Control how traffic is routed for a domain Route 53 - Hosted Zones A container for records that define how to route traffic to a domain and its subdomains Public Hosted Zone: contains records that specfy how to route traffic on the Internet (public domain names) Private Hosted Zones: contain records that specify how you route traffic within one or more VPCs (private domain names) application 1.company.internal You pay $0.50 per month per hosted zone Route 53: Public vs. Private Hosted Zone Public Hosted Zone: internet access Private Hosted Zone: unable to access from internet: EC2 instances, RDS instance Route 53 - Records TTL (Time To Live) High TTL - e.g 24 hr less traffic on Route 53 Possibily outdated records Low TTL - e.g 60 sec More traffics on Route 53 ($$) Records are outdated for less time Easy to change records Except for Alias records, TTL is mandatory for each DNS record CNAME vs Alias AWS Resources (Load Balancer, CloudFront…) expose an AWS hostname: b1-1234.us-east-2.elb.amazonaws.com and you want myapp.mydomain.com CNAME: Points a hostname to any other hostname. (app.mydomain.com =&gt; bla.bla.anything.com) Only for non root domain (aka. something.mydomain.com) Alias: Points a hostname to an AWS Resource Works for Root domain and non root domain (aka mydomain.com) Free of charge Native health check Route 53 - Alias Records Maps a hostname to an AWS resource An extension to DNS functionality Automatically recognizes changes in the resource’s IP addresses Unlike CNAME, it can be used for the top node of a DNS namespace (zone Apex), e.g: example.com Alias Record is always of type A/AAAA for AWS resources (IPv4/IPv6) You can’t set the TTL Route 53 - Alias REcords target Elastic Load Balancers CloudFront Distributions API Gateway Elastic Beantalk environments S3 Websites VPC Interface Endpoints Global Accelerator accelerator Route 53 record in the same hosted zone You cannot set an ALIAS record for an EC2 DNS name Route 53 - Routing policies Define how Route 53 responds to DNS queries Don’t get confused by the word “Routing” It’s not the same as load balancer routing which routes the traffic DNS does not route any traffic, it only responds to the DNS queries Route 53 support the following Routing policies Simple Weighted Failover Latency based GeoLocation Multi-Value Answer Geoproximity (using Route 53 Traffic Flow feature) Routing Policies - Simple Typically route traffic to a single resource Can specify multiple values in the same record If multiple values are returned, a random one is chosen be the client When Alias enabled, specify only one AWS resource Can’t be associated with Health Checks Routing Policies – Weighted Control the % of the requests that go to each specific resource Assign each record a relative weight traffic(%) = Weight for a specific record / sum all the weights for all records Weights don’t need to sum up to 100 DNS records must have the same name and type Can be associated with Health Checks Use cases: Load balancing between regions, testing new application versions… Assign a weight of 0 to a record to stop sending traffic to a resource If all records have weight of 0, then all records will be returned equally Routing Policies - Latency based Redirected to the resource that has the least latency close to us Super helpful when latency for users is a priority Latency is based on traffic betwwen users and AWS Regions Germany users may be directed to be the US (if that’s the lowest latency) Can be associated with Health Checks (has a failover capability) Route 53 - Health Checks HTTP Health Checks are only for public resources Health Check =&gt; Automated DNS Failover: Health checks that monitor an endpoint (application, server, other AWS resource) Health checks that monitor other health checks (Calculated Health Checks) Health checks that monitor CloudWatch Alarms (full control !!) - e.g throttles of DynamoDB, alarms on RDS, custom metrics, … (helpful for private resources) Health Checks are integrated with CW metrics Health Checks – Monitor an Endpoint About 15 global health checkers will check the endpoint health Health/Unhealthy Threshold - 3 (default) Interval - 30 sec (can set to 10 sec - higher cost) Supported protocol: HTTP, HTTPS and TCP If &gt; 18% of health checkers report the endpoint is health, Route 53 considers it Health. Otherwise, it’s Unhealty Ability to choose which locations you want Route 53 to use Health Checks pass only when the endpoint respond with the 2xx and 3xx status codes Health Checks can be setup to pass / fail based on the text in the first 5120 bytes of the response Configure you router/firewall to allow incoming requests from Route 53 Health Checkers Route 53 - Calculated health checks Combine the results of multiple Health Checks into a single Health Check You can use Or, AND, or NOT Can monitor up to 256 Child Health Checks Specify how many of the health checks need to pass to make the parent pass Usage: perform maintenance to your website without causing all health check to fail Health Checks – Private Hosted Zones Route 53 health checkers are outside the VPC They can’t access private endpoints (private VPC or on-premises resource) You can create a CloudWatch Metric and associate a CloudWatch Alarm, then create a Health Check that checks the alarm itself Routing Policies - Failover (Active - Passive) Routing Policies Geolocation Different from latency-based! This routing is based on user location Specify location by COntinent, Country or by US State (if there’s overlaping, most precise location selected) Should create a “Default” record (in case there’s no match on location) Use cases: website localization, restrict content distribution, load balancing, … Can be associated with Health Checks Routing Policies – Geoproximity Route traffic to your resources based on the geographic location of users and resources Ability to shift more traffic to resources based on the defined bias To change the size of the geographic region, specify bias values To expand ( 1 to 99): more traffic to resource To shrink (-1 to -99): less traffic to the resource Resources can be: AWS resources (specify AWS region) Non-AWS resources (specify latitude and longitude) You must use Route 53 traffic flow to use this feature Routing Policies - Geoproximity Routing 53 - Traffic flow Simplify the process of creating and maintaining records in large and complex configurations Visual editor to manage complex routing decision trees Configurations can be saved as TRaffic Flow Policy Can be applied to different Route 53 Hosted Zones (different domain names) Supports versioning Routing Policies - Multi value Use when routing traffic to multiple resources Route 53 return multiple value/resources Can be associated with Health Checks (return only values for healthy resources) Up to 8 healthy records are returned for each Multi-Value query Multi-value is not a substitude for having an ELB Domain Registar vs DNS Service You buy or register you domain name with a Domain Registar typically by paying annual charges (e.g GoDaddy, Amazone Registar Inc, …) The Domain Registar ussually provides you with a DNS service to manage your DNS records But you can use another DNS service to manage your DNS records Example: purchase the domain from GoDaddy and use Route 53 manage your DNS records GoDaddy as Registrar &amp; Route 53 as DNS Service 3rd Party Registrar with Amazon Route 53 If you buy your domain on a 3rd party registrar, you can still use Route 53 as the DNS Service provider Create a Hosted Zone in Route 53 Update NS Records on 3rd party website to use Route 53 Name Servers Domain Registar != DNS Service But every Domain Registrar usually comes with some DNS features A record mapping to IPv4 AAAA record mapping to IPv6 CNAME records shortcuts to hostname CNAME ftp CNAME mail CNAME wwww google.com zone MX records how email work MX 10 mail MX 20 mail.other.domain TXT records — query txt, spam TTL 3600 Time to live , numeric value in seconds authoritative TTL 3600 Non-Authoritative TTL The time for which a DNS resolver caches a response is set by a value called the time to live (TTL) associated with every record. Amazon Route 53 does not have a default TTL for any record type. NS: how the root zone delegates control of .org to the .org registry" /><meta property="og:description" content="Route 53 Section What is DNS Domain Name System which translates the human friendly hostnames into the machine IP address www.google.com =&gt; 172.2.17.18.36 DNS is the backbone of the internet DNS uses hierachical naming structure DNS Terminologies Domain Registrar: Amazon Route 53, GoDaddy, … DNS Records: A, AAAA, CNAME, NS, … Zone file: contains DNS records Name Server: resolves DNS queries (Authoritative or Non- Authoritative) Top Level Domain (TLD): .com, .us, .in, .gov, .org, … Second Level Domain (SLD): amazon.com, google.com, … How DNS works Web browser -&gt; Local DNS Server: Root DNS Server managed by ICANN (res: .com NS 1.2.3.4) TLD DNS Server managed by IANA (res: domain NS 5.6.7.8) SLD DNS Server managed by Domain Registrar (res: domain IP) Amazon Route 53 A highly available, scalable, fully managed and Authoritative DNS Authoritative = the customer (you) can update the DNS records Route 53 is also a Domain Registrar Ability to check the health of your resources The only AWS service which provide 100% availability SLA Why Route 53? 53 is a reference to the traditional DNS port Route53 - Records How you want to route traffic for a domain Each record contains: Domain/subdomain Name: example.com RecordType: e.g A or AAAA Value: 12.34.56.78 Routing Policy: How Route 53 responds to queries TTL: amount of time the record cached at DNS resolvers Route 53 supports the following DNS record types: A / AAAA / CNAME / NS CAA / DS / MX / NAPTR / PTR / SOA / TXT / SPF / SRV Route 53 - Record Types A: maps a hostname to Ipv4 AAAA: maps a hostname to IPv6 CNAME: maps a hostname to another hostname The target is a domain name which must have an A or AAAA record Can’t create a CNAME record for the top node of a DNS namespace (Zone Apex) Exmaple: you can’t create for example.com but you create for www.example.com NS: name Server for the hosted zone Control how traffic is routed for a domain Route 53 - Hosted Zones A container for records that define how to route traffic to a domain and its subdomains Public Hosted Zone: contains records that specfy how to route traffic on the Internet (public domain names) Private Hosted Zones: contain records that specify how you route traffic within one or more VPCs (private domain names) application 1.company.internal You pay $0.50 per month per hosted zone Route 53: Public vs. Private Hosted Zone Public Hosted Zone: internet access Private Hosted Zone: unable to access from internet: EC2 instances, RDS instance Route 53 - Records TTL (Time To Live) High TTL - e.g 24 hr less traffic on Route 53 Possibily outdated records Low TTL - e.g 60 sec More traffics on Route 53 ($$) Records are outdated for less time Easy to change records Except for Alias records, TTL is mandatory for each DNS record CNAME vs Alias AWS Resources (Load Balancer, CloudFront…) expose an AWS hostname: b1-1234.us-east-2.elb.amazonaws.com and you want myapp.mydomain.com CNAME: Points a hostname to any other hostname. (app.mydomain.com =&gt; bla.bla.anything.com) Only for non root domain (aka. something.mydomain.com) Alias: Points a hostname to an AWS Resource Works for Root domain and non root domain (aka mydomain.com) Free of charge Native health check Route 53 - Alias Records Maps a hostname to an AWS resource An extension to DNS functionality Automatically recognizes changes in the resource’s IP addresses Unlike CNAME, it can be used for the top node of a DNS namespace (zone Apex), e.g: example.com Alias Record is always of type A/AAAA for AWS resources (IPv4/IPv6) You can’t set the TTL Route 53 - Alias REcords target Elastic Load Balancers CloudFront Distributions API Gateway Elastic Beantalk environments S3 Websites VPC Interface Endpoints Global Accelerator accelerator Route 53 record in the same hosted zone You cannot set an ALIAS record for an EC2 DNS name Route 53 - Routing policies Define how Route 53 responds to DNS queries Don’t get confused by the word “Routing” It’s not the same as load balancer routing which routes the traffic DNS does not route any traffic, it only responds to the DNS queries Route 53 support the following Routing policies Simple Weighted Failover Latency based GeoLocation Multi-Value Answer Geoproximity (using Route 53 Traffic Flow feature) Routing Policies - Simple Typically route traffic to a single resource Can specify multiple values in the same record If multiple values are returned, a random one is chosen be the client When Alias enabled, specify only one AWS resource Can’t be associated with Health Checks Routing Policies – Weighted Control the % of the requests that go to each specific resource Assign each record a relative weight traffic(%) = Weight for a specific record / sum all the weights for all records Weights don’t need to sum up to 100 DNS records must have the same name and type Can be associated with Health Checks Use cases: Load balancing between regions, testing new application versions… Assign a weight of 0 to a record to stop sending traffic to a resource If all records have weight of 0, then all records will be returned equally Routing Policies - Latency based Redirected to the resource that has the least latency close to us Super helpful when latency for users is a priority Latency is based on traffic betwwen users and AWS Regions Germany users may be directed to be the US (if that’s the lowest latency) Can be associated with Health Checks (has a failover capability) Route 53 - Health Checks HTTP Health Checks are only for public resources Health Check =&gt; Automated DNS Failover: Health checks that monitor an endpoint (application, server, other AWS resource) Health checks that monitor other health checks (Calculated Health Checks) Health checks that monitor CloudWatch Alarms (full control !!) - e.g throttles of DynamoDB, alarms on RDS, custom metrics, … (helpful for private resources) Health Checks are integrated with CW metrics Health Checks – Monitor an Endpoint About 15 global health checkers will check the endpoint health Health/Unhealthy Threshold - 3 (default) Interval - 30 sec (can set to 10 sec - higher cost) Supported protocol: HTTP, HTTPS and TCP If &gt; 18% of health checkers report the endpoint is health, Route 53 considers it Health. Otherwise, it’s Unhealty Ability to choose which locations you want Route 53 to use Health Checks pass only when the endpoint respond with the 2xx and 3xx status codes Health Checks can be setup to pass / fail based on the text in the first 5120 bytes of the response Configure you router/firewall to allow incoming requests from Route 53 Health Checkers Route 53 - Calculated health checks Combine the results of multiple Health Checks into a single Health Check You can use Or, AND, or NOT Can monitor up to 256 Child Health Checks Specify how many of the health checks need to pass to make the parent pass Usage: perform maintenance to your website without causing all health check to fail Health Checks – Private Hosted Zones Route 53 health checkers are outside the VPC They can’t access private endpoints (private VPC or on-premises resource) You can create a CloudWatch Metric and associate a CloudWatch Alarm, then create a Health Check that checks the alarm itself Routing Policies - Failover (Active - Passive) Routing Policies Geolocation Different from latency-based! This routing is based on user location Specify location by COntinent, Country or by US State (if there’s overlaping, most precise location selected) Should create a “Default” record (in case there’s no match on location) Use cases: website localization, restrict content distribution, load balancing, … Can be associated with Health Checks Routing Policies – Geoproximity Route traffic to your resources based on the geographic location of users and resources Ability to shift more traffic to resources based on the defined bias To change the size of the geographic region, specify bias values To expand ( 1 to 99): more traffic to resource To shrink (-1 to -99): less traffic to the resource Resources can be: AWS resources (specify AWS region) Non-AWS resources (specify latitude and longitude) You must use Route 53 traffic flow to use this feature Routing Policies - Geoproximity Routing 53 - Traffic flow Simplify the process of creating and maintaining records in large and complex configurations Visual editor to manage complex routing decision trees Configurations can be saved as TRaffic Flow Policy Can be applied to different Route 53 Hosted Zones (different domain names) Supports versioning Routing Policies - Multi value Use when routing traffic to multiple resources Route 53 return multiple value/resources Can be associated with Health Checks (return only values for healthy resources) Up to 8 healthy records are returned for each Multi-Value query Multi-value is not a substitude for having an ELB Domain Registar vs DNS Service You buy or register you domain name with a Domain Registar typically by paying annual charges (e.g GoDaddy, Amazone Registar Inc, …) The Domain Registar ussually provides you with a DNS service to manage your DNS records But you can use another DNS service to manage your DNS records Example: purchase the domain from GoDaddy and use Route 53 manage your DNS records GoDaddy as Registrar &amp; Route 53 as DNS Service 3rd Party Registrar with Amazon Route 53 If you buy your domain on a 3rd party registrar, you can still use Route 53 as the DNS Service provider Create a Hosted Zone in Route 53 Update NS Records on 3rd party website to use Route 53 Name Servers Domain Registar != DNS Service But every Domain Registrar usually comes with some DNS features A record mapping to IPv4 AAAA record mapping to IPv6 CNAME records shortcuts to hostname CNAME ftp CNAME mail CNAME wwww google.com zone MX records how email work MX 10 mail MX 20 mail.other.domain TXT records — query txt, spam TTL 3600 Time to live , numeric value in seconds authoritative TTL 3600 Non-Authoritative TTL The time for which a DNS resolver caches a response is set by a value called the time to live (TTL) associated with every record. Amazon Route 53 does not have a default TTL for any record type. NS: how the root zone delegates control of .org to the .org registry" /><link rel="canonical" href="https://hardworkenglishlearner.github.io/posts/aws-router-53/" /><meta property="og:url" content="https://hardworkenglishlearner.github.io/posts/aws-router-53/" /><meta property="og:site_name" content="Programmer From Zero To Mountaint" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-02-07T00:00:00+07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="AWS Router 53" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Hardwork đẹp trai" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Hardwork đẹp trai"},"dateModified":"2024-02-07T00:00:00+07:00","datePublished":"2024-02-07T00:00:00+07:00","description":"Route 53 Section What is DNS Domain Name System which translates the human friendly hostnames into the machine IP address www.google.com =&gt; 172.2.17.18.36 DNS is the backbone of the internet DNS uses hierachical naming structure DNS Terminologies Domain Registrar: Amazon Route 53, GoDaddy, … DNS Records: A, AAAA, CNAME, NS, … Zone file: contains DNS records Name Server: resolves DNS queries (Authoritative or Non- Authoritative) Top Level Domain (TLD): .com, .us, .in, .gov, .org, … Second Level Domain (SLD): amazon.com, google.com, … How DNS works Web browser -&gt; Local DNS Server: Root DNS Server managed by ICANN (res: .com NS 1.2.3.4) TLD DNS Server managed by IANA (res: domain NS 5.6.7.8) SLD DNS Server managed by Domain Registrar (res: domain IP) Amazon Route 53 A highly available, scalable, fully managed and Authoritative DNS Authoritative = the customer (you) can update the DNS records Route 53 is also a Domain Registrar Ability to check the health of your resources The only AWS service which provide 100% availability SLA Why Route 53? 53 is a reference to the traditional DNS port Route53 - Records How you want to route traffic for a domain Each record contains: Domain/subdomain Name: example.com RecordType: e.g A or AAAA Value: 12.34.56.78 Routing Policy: How Route 53 responds to queries TTL: amount of time the record cached at DNS resolvers Route 53 supports the following DNS record types: A / AAAA / CNAME / NS CAA / DS / MX / NAPTR / PTR / SOA / TXT / SPF / SRV Route 53 - Record Types A: maps a hostname to Ipv4 AAAA: maps a hostname to IPv6 CNAME: maps a hostname to another hostname The target is a domain name which must have an A or AAAA record Can’t create a CNAME record for the top node of a DNS namespace (Zone Apex) Exmaple: you can’t create for example.com but you create for www.example.com NS: name Server for the hosted zone Control how traffic is routed for a domain Route 53 - Hosted Zones A container for records that define how to route traffic to a domain and its subdomains Public Hosted Zone: contains records that specfy how to route traffic on the Internet (public domain names) Private Hosted Zones: contain records that specify how you route traffic within one or more VPCs (private domain names) application 1.company.internal You pay $0.50 per month per hosted zone Route 53: Public vs. Private Hosted Zone Public Hosted Zone: internet access Private Hosted Zone: unable to access from internet: EC2 instances, RDS instance Route 53 - Records TTL (Time To Live) High TTL - e.g 24 hr less traffic on Route 53 Possibily outdated records Low TTL - e.g 60 sec More traffics on Route 53 ($$) Records are outdated for less time Easy to change records Except for Alias records, TTL is mandatory for each DNS record CNAME vs Alias AWS Resources (Load Balancer, CloudFront…) expose an AWS hostname: b1-1234.us-east-2.elb.amazonaws.com and you want myapp.mydomain.com CNAME: Points a hostname to any other hostname. (app.mydomain.com =&gt; bla.bla.anything.com) Only for non root domain (aka. something.mydomain.com) Alias: Points a hostname to an AWS Resource Works for Root domain and non root domain (aka mydomain.com) Free of charge Native health check Route 53 - Alias Records Maps a hostname to an AWS resource An extension to DNS functionality Automatically recognizes changes in the resource’s IP addresses Unlike CNAME, it can be used for the top node of a DNS namespace (zone Apex), e.g: example.com Alias Record is always of type A/AAAA for AWS resources (IPv4/IPv6) You can’t set the TTL Route 53 - Alias REcords target Elastic Load Balancers CloudFront Distributions API Gateway Elastic Beantalk environments S3 Websites VPC Interface Endpoints Global Accelerator accelerator Route 53 record in the same hosted zone You cannot set an ALIAS record for an EC2 DNS name Route 53 - Routing policies Define how Route 53 responds to DNS queries Don’t get confused by the word “Routing” It’s not the same as load balancer routing which routes the traffic DNS does not route any traffic, it only responds to the DNS queries Route 53 support the following Routing policies Simple Weighted Failover Latency based GeoLocation Multi-Value Answer Geoproximity (using Route 53 Traffic Flow feature) Routing Policies - Simple Typically route traffic to a single resource Can specify multiple values in the same record If multiple values are returned, a random one is chosen be the client When Alias enabled, specify only one AWS resource Can’t be associated with Health Checks Routing Policies – Weighted Control the % of the requests that go to each specific resource Assign each record a relative weight traffic(%) = Weight for a specific record / sum all the weights for all records Weights don’t need to sum up to 100 DNS records must have the same name and type Can be associated with Health Checks Use cases: Load balancing between regions, testing new application versions… Assign a weight of 0 to a record to stop sending traffic to a resource If all records have weight of 0, then all records will be returned equally Routing Policies - Latency based Redirected to the resource that has the least latency close to us Super helpful when latency for users is a priority Latency is based on traffic betwwen users and AWS Regions Germany users may be directed to be the US (if that’s the lowest latency) Can be associated with Health Checks (has a failover capability) Route 53 - Health Checks HTTP Health Checks are only for public resources Health Check =&gt; Automated DNS Failover: Health checks that monitor an endpoint (application, server, other AWS resource) Health checks that monitor other health checks (Calculated Health Checks) Health checks that monitor CloudWatch Alarms (full control !!) - e.g throttles of DynamoDB, alarms on RDS, custom metrics, … (helpful for private resources) Health Checks are integrated with CW metrics Health Checks – Monitor an Endpoint About 15 global health checkers will check the endpoint health Health/Unhealthy Threshold - 3 (default) Interval - 30 sec (can set to 10 sec - higher cost) Supported protocol: HTTP, HTTPS and TCP If &gt; 18% of health checkers report the endpoint is health, Route 53 considers it Health. Otherwise, it’s Unhealty Ability to choose which locations you want Route 53 to use Health Checks pass only when the endpoint respond with the 2xx and 3xx status codes Health Checks can be setup to pass / fail based on the text in the first 5120 bytes of the response Configure you router/firewall to allow incoming requests from Route 53 Health Checkers Route 53 - Calculated health checks Combine the results of multiple Health Checks into a single Health Check You can use Or, AND, or NOT Can monitor up to 256 Child Health Checks Specify how many of the health checks need to pass to make the parent pass Usage: perform maintenance to your website without causing all health check to fail Health Checks – Private Hosted Zones Route 53 health checkers are outside the VPC They can’t access private endpoints (private VPC or on-premises resource) You can create a CloudWatch Metric and associate a CloudWatch Alarm, then create a Health Check that checks the alarm itself Routing Policies - Failover (Active - Passive) Routing Policies Geolocation Different from latency-based! This routing is based on user location Specify location by COntinent, Country or by US State (if there’s overlaping, most precise location selected) Should create a “Default” record (in case there’s no match on location) Use cases: website localization, restrict content distribution, load balancing, … Can be associated with Health Checks Routing Policies – Geoproximity Route traffic to your resources based on the geographic location of users and resources Ability to shift more traffic to resources based on the defined bias To change the size of the geographic region, specify bias values To expand ( 1 to 99): more traffic to resource To shrink (-1 to -99): less traffic to the resource Resources can be: AWS resources (specify AWS region) Non-AWS resources (specify latitude and longitude) You must use Route 53 traffic flow to use this feature Routing Policies - Geoproximity Routing 53 - Traffic flow Simplify the process of creating and maintaining records in large and complex configurations Visual editor to manage complex routing decision trees Configurations can be saved as TRaffic Flow Policy Can be applied to different Route 53 Hosted Zones (different domain names) Supports versioning Routing Policies - Multi value Use when routing traffic to multiple resources Route 53 return multiple value/resources Can be associated with Health Checks (return only values for healthy resources) Up to 8 healthy records are returned for each Multi-Value query Multi-value is not a substitude for having an ELB Domain Registar vs DNS Service You buy or register you domain name with a Domain Registar typically by paying annual charges (e.g GoDaddy, Amazone Registar Inc, …) The Domain Registar ussually provides you with a DNS service to manage your DNS records But you can use another DNS service to manage your DNS records Example: purchase the domain from GoDaddy and use Route 53 manage your DNS records GoDaddy as Registrar &amp; Route 53 as DNS Service 3rd Party Registrar with Amazon Route 53 If you buy your domain on a 3rd party registrar, you can still use Route 53 as the DNS Service provider Create a Hosted Zone in Route 53 Update NS Records on 3rd party website to use Route 53 Name Servers Domain Registar != DNS Service But every Domain Registrar usually comes with some DNS features A record mapping to IPv4 AAAA record mapping to IPv6 CNAME records shortcuts to hostname CNAME ftp CNAME mail CNAME wwww google.com zone MX records how email work MX 10 mail MX 20 mail.other.domain TXT records — query txt, spam TTL 3600 Time to live , numeric value in seconds authoritative TTL 3600 Non-Authoritative TTL The time for which a DNS resolver caches a response is set by a value called the time to live (TTL) associated with every record. Amazon Route 53 does not have a default TTL for any record type. NS: how the root zone delegates control of .org to the .org registry","headline":"AWS Router 53","mainEntityOfPage":{"@type":"WebPage","@id":"https://hardworkenglishlearner.github.io/posts/aws-router-53/"},"url":"https://hardworkenglishlearner.github.io/posts/aws-router-53/"}</script><meta name="pwa-cache" content="true"><title>AWS Router 53 | Programmer From Zero To Mountaint</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Programmer From Zero To Mountaint"><meta name="application-name" content="Programmer From Zero To Mountaint"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="preconnect" href="https://polyfill.io" ><link rel="dns-prefetch" href="https://polyfill.io" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/avatar.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/">Programmer From Zero To Mountaint</a></h1><p class="site-subtitle fst-italic mb-0">Programmer blog</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/portfoio/" class="nav-link"> <i class="fa-fw fas fa-paper-plane"></i> <span>PORTFOLIO</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/hardworkenglishlearner" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['huybinh.ad','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://www.linkedin.com/in/b%C3%ACnh-nguy%E1%BB%85n-75312a7b/" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>AWS Router 53</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>AWS Router 53</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1707238800" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Feb 7, 2024 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/username">Hardwork đẹp trai</a> </em> </span> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1703 words" > <em>9 min</em> read</span></div></div></header><div class="content"><h1 id="route-53-section">Route 53 Section</h1><h2 id="what-is-dns"><span class="me-2">What is DNS</span><a href="#what-is-dns" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Domain Name System which translates the human friendly hostnames into the machine IP address<li>www.google.com =&gt; 172.2.17.18.36<li>DNS is the backbone of the internet<li>DNS uses hierachical naming structure<h2 id="dns-terminologies"><span class="me-2">DNS Terminologies</span><a href="#dns-terminologies" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><li>Domain Registrar: Amazon Route 53, GoDaddy, …<li>DNS Records: A, AAAA, CNAME, NS, …<li>Zone file: contains DNS records<li>Name Server: resolves DNS queries (Authoritative or Non- Authoritative)<li>Top Level Domain (TLD): .com, .us, .in, .gov, .org, …<li>Second Level Domain (SLD): amazon.com, google.com, …<h2 id="how-dns-works"><span class="me-2">How DNS works</span><a href="#how-dns-works" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><li>Web browser -&gt; Local DNS Server:<ul><li>Root DNS Server managed by ICANN (res: .com NS 1.2.3.4)<li>TLD DNS Server managed by IANA (res: domain NS 5.6.7.8)<li>SLD DNS Server managed by Domain Registrar (res: domain IP) <a href="https://imgdb.net/storage/uploads/00a27e53f531ebe25a7f7e29d35226b74a74666736a41b6b671c1e56e0a33a6c.png" class="popup img-link shimmer"><img src="https://imgdb.net/storage/uploads/00a27e53f531ebe25a7f7e29d35226b74a74666736a41b6b671c1e56e0a33a6c.png" alt="How DNS Work" title="How DNS Work" loading="lazy"></a><h2 id="amazon-route-53"><span class="me-2">Amazon Route 53</span><a href="#amazon-route-53" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></ul><li>A highly available, scalable, fully managed and Authoritative DNS<ul><li>Authoritative = the customer (you) can update the DNS records</ul><li>Route 53 is also a <strong>Domain Registrar</strong><li>Ability to check the health of your resources<li>The only AWS service which provide 100% availability SLA<li>Why Route 53? 53 is a reference to the traditional DNS port<h2 id="route53---records"><span class="me-2">Route53 - Records</span><a href="#route53---records" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><li>How you want to route traffic for a domain<li>Each record contains:<ul><li>Domain/subdomain Name: example.com<li>RecordType: e.g A or AAAA<li>Value: 12.34.56.78<li>Routing Policy: How Route 53 responds to queries<li>TTL: amount of time the record cached at DNS resolvers</ul><li>Route 53 supports the following DNS record types:<ul><li>A / AAAA / CNAME / NS<li>CAA / DS / MX / NAPTR / PTR / SOA / TXT / SPF / SRV<h2 id="route-53---record-types"><span class="me-2">Route 53 - Record Types</span><a href="#route-53---record-types" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></ul><li>A: maps a hostname to Ipv4<li>AAAA: maps a hostname to IPv6<li>CNAME: maps a hostname to another hostname<ul><li>The target is a domain name which must have an A or AAAA record<li>Can’t create a CNAME record for the top node of a DNS namespace (Zone Apex)<li>Exmaple: you can’t create for example.com but you create for www.example.com</ul><li>NS: name Server for the hosted zone<ul><li>Control how traffic is routed for a domain<h2 id="route-53---hosted-zones"><span class="me-2">Route 53 - Hosted Zones</span><a href="#route-53---hosted-zones" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></ul><li>A container for records that define how to route traffic to a domain and its subdomains<li>Public Hosted Zone: contains records that specfy how to route traffic on the Internet (public domain names)<li>Private Hosted Zones: contain records that specify how you route traffic within one or more VPCs (private domain names) application 1.company.internal<li>You pay $0.50 per month per hosted zone<h2 id="route-53-public-vs-private-hosted-zone"><span class="me-2">Route 53: Public vs. Private Hosted Zone</span><a href="#route-53-public-vs-private-hosted-zone" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><li>Public Hosted Zone: internet access<li>Private Hosted Zone: unable to access from internet: EC2 instances, RDS instance<h2 id="route-53---records-ttl-time-to-live"><span class="me-2">Route 53 - Records TTL (Time To Live)</span><a href="#route-53---records-ttl-time-to-live" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><li>High TTL - e.g 24 hr<ul><li>less traffic on Route 53<li>Possibily outdated records</ul><li>Low TTL - e.g 60 sec<ul><li>More traffics on Route 53 ($$)<li>Records are outdated for less time<li>Easy to change records</ul><li>Except for Alias records, TTL is mandatory for each DNS record<h2 id="cname-vs-alias"><span class="me-2">CNAME vs Alias</span><a href="#cname-vs-alias" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><li>AWS Resources (Load Balancer, CloudFront…) expose an AWS hostname:<ul><li>b1-1234.us-east-2.elb.amazonaws.com and you want myapp.mydomain.com</ul><li>CNAME:<ul><li>Points a hostname to any other hostname. (app.mydomain.com =&gt; bla.bla.anything.com)<li>Only for non root domain (aka. something.mydomain.com)</ul><li>Alias:<ul><li>Points a hostname to an AWS Resource<li>Works for Root domain and non root domain (aka mydomain.com)<li>Free of charge<li>Native health check<h2 id="route-53---alias-records"><span class="me-2">Route 53 - Alias Records</span><a href="#route-53---alias-records" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></ul><li>Maps a hostname to an AWS resource<li>An extension to DNS functionality<li>Automatically recognizes changes in the resource’s IP addresses<li>Unlike CNAME, it can be used for the top node of a DNS namespace (zone Apex), e.g: example.com<li>Alias Record is always of type A/AAAA for AWS resources (IPv4/IPv6)<li>You can’t set the TTL<h2 id="route-53---alias-records-target"><span class="me-2">Route 53 - Alias REcords target</span><a href="#route-53---alias-records-target" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><li>Elastic Load Balancers<li>CloudFront Distributions<li>API Gateway<li>Elastic Beantalk environments<li>S3 Websites<li>VPC Interface Endpoints<li>Global Accelerator accelerator<li>Route 53 record in the same hosted zone<li>You cannot set an ALIAS record for an EC2 DNS name <a href="https://imgdb.net/storage/uploads/6c961263367d0b206788eea8ad425e630759ad225eb18754163ee366e50aa615.png" class="popup img-link shimmer"><img src="https://imgdb.net/storage/uploads/6c961263367d0b206788eea8ad425e630759ad225eb18754163ee366e50aa615.png" alt="Alias Record target" title="Alias Record target" loading="lazy"></a><h2 id="route-53---routing-policies"><span class="me-2">Route 53 - Routing policies</span><a href="#route-53---routing-policies" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><li>Define how Route 53 responds to DNS queries<li>Don’t get confused by the word “Routing”<ul><li>It’s not the same as load balancer routing which routes the traffic<li>DNS does not route any traffic, it only responds to the DNS queries</ul><li>Route 53 support the following Routing policies<ul><li>Simple<li>Weighted<li>Failover<li>Latency based<li>GeoLocation<li>Multi-Value Answer<li>Geoproximity (using Route 53 Traffic Flow feature)<h2 id="routing-policies---simple"><span class="me-2">Routing Policies - Simple</span><a href="#routing-policies---simple" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></ul><li>Typically route traffic to a single resource<li>Can specify multiple values in the same record<li>If multiple values are returned, a random one is chosen be the client<li>When Alias enabled, specify only one AWS resource<li>Can’t be associated with Health Checks <a href="https://imgdb.net/storage/uploads/4884255131af7b8e1c20b85ac61bed9d3c2758647f177f258cc9d404c6abcad4.png" class="popup img-link shimmer"><img src="https://imgdb.net/storage/uploads/4884255131af7b8e1c20b85ac61bed9d3c2758647f177f258cc9d404c6abcad4.png" alt="Routing policices" title="Routing policies Simple" loading="lazy"></a><h2 id="routing-policies--weighted"><span class="me-2">Routing Policies – Weighted</span><a href="#routing-policies--weighted" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><li>Control the % of the requests that go to each specific resource<li>Assign each record a relative weight<ul><li>traffic(%) = Weight for a specific record / sum all the weights for all records<li>Weights don’t need to sum up to 100</ul><li>DNS records must have the same name and type<li>Can be associated with Health Checks<li>Use cases: Load balancing between regions, testing new application versions…<li>Assign a weight of 0 to a record to stop sending traffic to a resource<li>If all records have weight of 0, then all records will be returned equally <a href="https://imgdb.net/storage/uploads/485743df9a027b3d167ae6146cd21d334e04c9c6e7aae508fa07eb9a3d21d88a.png" class="popup img-link shimmer"><img src="https://imgdb.net/storage/uploads/485743df9a027b3d167ae6146cd21d334e04c9c6e7aae508fa07eb9a3d21d88a.png" alt="Routing Policies Weighted" loading="lazy"></a><h2 id="routing-policies---latency-based"><span class="me-2">Routing Policies - Latency based</span><a href="#routing-policies---latency-based" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><li>Redirected to the resource that has the least latency close to us<li>Super helpful when latency for users is a priority<li>Latency is based on traffic betwwen users and AWS Regions<li>Germany users may be directed to be the US (if that’s the lowest latency)<li>Can be associated with Health Checks (has a failover capability)<h2 id="route-53---health-checks"><span class="me-2">Route 53 - Health Checks</span><a href="#route-53---health-checks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><li>HTTP Health Checks are only for public resources<li>Health Check =&gt; Automated DNS Failover:<ul><li>Health checks that monitor an endpoint (application, server, other AWS resource)<li>Health checks that monitor other health checks (Calculated Health Checks)<li>Health checks that monitor CloudWatch Alarms (full control !!) - e.g throttles of DynamoDB, alarms on RDS, custom metrics, … (helpful for private resources)</ul><li>Health Checks are integrated with CW metrics<h2 id="health-checks--monitor-an-endpoint"><span class="me-2">Health Checks – Monitor an Endpoint</span><a href="#health-checks--monitor-an-endpoint" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><li>About 15 global health checkers will check the endpoint health<ul><li>Health/Unhealthy Threshold - 3 (default)<li>Interval - 30 sec (can set to 10 sec - higher cost)<li>Supported protocol: HTTP, HTTPS and TCP<li>If &gt; 18% of health checkers report the endpoint is health, Route 53 considers it Health. Otherwise, it’s Unhealty<li>Ability to choose which locations you want Route 53 to use</ul><li>Health Checks pass only when the endpoint respond with the 2xx and 3xx status codes<li>Health Checks can be setup to pass / fail based on the text in the first 5120 bytes of the response<li>Configure you router/firewall to allow incoming requests from Route 53 Health Checkers<h2 id="route-53---calculated-health-checks"><span class="me-2">Route 53 - Calculated health checks</span><a href="#route-53---calculated-health-checks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><li>Combine the results of multiple Health Checks into a single Health Check<li>You can use Or, AND, or NOT<li>Can monitor up to 256 Child Health Checks<li>Specify how many of the health checks need to pass to make the parent pass<li>Usage: perform maintenance to your website without causing all health check to fail <a href="https://imgdb.net/storage/uploads/39a6d176165780da3abb2e4bbb50fe49c505610a4546c4879913ad0ce52edb8c.png" class="popup img-link shimmer"><img src="https://imgdb.net/storage/uploads/39a6d176165780da3abb2e4bbb50fe49c505610a4546c4879913ad0ce52edb8c.png" alt="Calculate health checks" title="calculate health check" loading="lazy"></a><h2 id="health-checks--private-hosted-zones"><span class="me-2">Health Checks – Private Hosted Zones</span><a href="#health-checks--private-hosted-zones" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><li>Route 53 health checkers are outside the VPC<li>They can’t access private endpoints (private VPC or on-premises resource)<li>You can create a CloudWatch Metric and associate a CloudWatch Alarm, then create a Health Check that checks the alarm itself <a href="https://imgdb.net/storage/uploads/00463594265312d25b1de8cd1a7e99cf9adcf72c0447ed2562883f5ce88eb146.png" class="popup img-link shimmer"><img src="https://imgdb.net/storage/uploads/00463594265312d25b1de8cd1a7e99cf9adcf72c0447ed2562883f5ce88eb146.png" alt="Privated Hosted Zones" title="Private Hosted Zone" loading="lazy"></a><h2 id="routing-policies---failover-active---passive"><span class="me-2">Routing Policies - Failover (Active - Passive)</span><a href="#routing-policies---failover-active---passive" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://imgdb.net/storage/uploads/01014d3db6296577fe8b27a7366eccd7c34a9ef56854e7dd8a8251a3d94ddf55.png" class="popup img-link shimmer"><img src="https://imgdb.net/storage/uploads/01014d3db6296577fe8b27a7366eccd7c34a9ef56854e7dd8a8251a3d94ddf55.png" alt="Routing Policies – Failover" title="Routing Policies Failover" loading="lazy"></a></p><h2 id="routing-policies-geolocation"><span class="me-2">Routing Policies Geolocation</span><a href="#routing-policies-geolocation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><li>Different from latency-based!<li>This routing is based on user location<li>Specify location by COntinent, Country or by US State (if there’s overlaping, most precise location selected)<li>Should create a “Default” record (in case there’s no match on location)<li>Use cases: website localization, restrict content distribution, load balancing, …<li>Can be associated with Health Checks<h2 id="routing-policies--geoproximity"><span class="me-2">Routing Policies – Geoproximity</span><a href="#routing-policies--geoproximity" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><li>Route traffic to your resources based on the geographic location of users and resources<li>Ability to shift more traffic to resources based on the defined bias<li>To change the size of the geographic region, specify bias values<ul><li>To expand ( 1 to 99): more traffic to resource<li>To shrink (-1 to -99): less traffic to the resource</ul><li>Resources can be:<ul><li>AWS resources (specify AWS region)<li>Non-AWS resources (specify latitude and longitude)</ul><li>You must use Route 53 traffic flow to use this feature<h2 id="routing-policies---geoproximity"><span class="me-2">Routing Policies - Geoproximity</span><a href="#routing-policies---geoproximity" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://imgdb.net/storage/uploads/ba6c513a1cdf1d394384356cba5223927a883019264e71b0712b02fdc52e16b4.png" class="popup img-link shimmer"><img src="https://imgdb.net/storage/uploads/ba6c513a1cdf1d394384356cba5223927a883019264e71b0712b02fdc52e16b4.png" alt="Geoproximity" loading="lazy"></a> <a href="https://imgdb.net/storage/uploads/ac09a509e13b75fee0288bde2e8c64fda773ec8a5b2cc3a05a0c5d13aae36cff.png" class="popup img-link shimmer"><img src="https://imgdb.net/storage/uploads/ac09a509e13b75fee0288bde2e8c64fda773ec8a5b2cc3a05a0c5d13aae36cff.png" alt="Geoproximity" loading="lazy"></a></p><h2 id="routing-53---traffic-flow"><span class="me-2">Routing 53 - Traffic flow</span><a href="#routing-53---traffic-flow" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><li>Simplify the process of creating and maintaining records in large and complex configurations<li><strong>Visual editor</strong> to manage complex routing decision trees<li>Configurations can be saved as TRaffic Flow Policy<ul><li>Can be applied to different Route 53 Hosted Zones (different domain names)<li>Supports versioning<h2 id="routing-policies---multi-value"><span class="me-2">Routing Policies - Multi value</span><a href="#routing-policies---multi-value" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></ul><li>Use when routing traffic to multiple resources<li>Route 53 return multiple value/resources<li>Can be associated with Health Checks (return only values for healthy resources)<li>Up to 8 healthy records are returned for each Multi-Value query<li>Multi-value is not a substitude for having an ELB<h2 id="domain-registar-vs-dns-service"><span class="me-2">Domain Registar vs DNS Service</span><a href="#domain-registar-vs-dns-service" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><li>You buy or register you domain name with a Domain Registar typically by paying annual charges (e.g GoDaddy, Amazone Registar Inc, …)<li>The Domain Registar ussually provides you with a DNS service to manage your DNS records<li>But you can use another DNS service to manage your DNS records<li>Example: purchase the domain from GoDaddy and use Route 53 manage your DNS records <a href="https://imgdb.net/storage/uploads/631e7d131943832677528a4ee3110911123ca55414554900b5e5f79c362d6797.png" class="popup img-link shimmer"><img src="https://imgdb.net/storage/uploads/631e7d131943832677528a4ee3110911123ca55414554900b5e5f79c362d6797.png" alt="AWS DNS" loading="lazy"></a><h2 id="godaddy-as-registrar--route-53-as-dns-service"><span class="me-2">GoDaddy as Registrar &amp; Route 53 as DNS Service</span><a href="#godaddy-as-registrar--route-53-as-dns-service" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://imgdb.net/storage/uploads/f275c0eb7f25353a67ef12df2491fd5ff7f1ecfe8e5873726717137207b19bae.png" class="popup img-link shimmer"><img src="https://imgdb.net/storage/uploads/f275c0eb7f25353a67ef12df2491fd5ff7f1ecfe8e5873726717137207b19bae.png" alt="" loading="lazy"></a></p><h2 id="3rd-party-registrar-with-amazon-route-53"><span class="me-2">3rd Party Registrar with Amazon Route 53</span><a href="#3rd-party-registrar-with-amazon-route-53" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><li>If you buy your domain on a 3rd party registrar, you can still use Route 53 as the DNS Service provider<ol><li>Create a Hosted Zone in Route 53<li>Update NS Records on 3rd party website to use Route 53 Name Servers<li>Domain Registar != DNS Service<li>But every Domain Registrar usually comes with some DNS features</ol><li>A record mapping to IPv4<li>AAAA record mapping to IPv6<li>CNAME records shortcuts to hostname<li>CNAME ftp<li>CNAME mail<li>CNAME wwww google.com zone<li>MX records how email work<li>MX 10 mail<li>MX 20 mail.other.domain<li>TXT records — query txt, spam<li>TTL 3600 Time to live , numeric value in seconds authoritative<li>TTL 3600 Non-Authoritative<li>TTL The time for which a DNS resolver caches a response is set by a value called the time to live (TTL) associated with every record. Amazon Route 53 does not have a default TTL for any record type.<li>NS: how the root zone delegates control of .org to the .org registry</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/fullstack/">Fullstack</a>, <a href="/categories/blogging/">Blogging</a>, <a href="/categories/aws/">AWS</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/aws/" class="post-tag no-text-decoration" >aws</a> <a href="/tags/router53/" class="post-tag no-text-decoration" >router53</a> <a href="/tags/dns/" class="post-tag no-text-decoration" >DNS</a> <a href="/tags/a/" class="post-tag no-text-decoration" >A</a> <a href="/tags/aa/" class="post-tag no-text-decoration" >AA</a> <a href="/tags/cname/" class="post-tag no-text-decoration" >CNAME</a> <a href="/tags/mx/" class="post-tag no-text-decoration" >MX</a> <a href="/tags/txt/" class="post-tag no-text-decoration" >TXT</a> <a href="/tags/ttl/" class="post-tag no-text-decoration" >TTL</a> <a href="/tags/ns/" class="post-tag no-text-decoration" >NS</a> <a href="/tags/hosted-zones/" class="post-tag no-text-decoration" >Hosted Zones</a> <a href="/tags/geoproximity/" class="post-tag no-text-decoration" >Geoproximity</a> <a href="/tags/traffic-flow/" class="post-tag no-text-decoration" >Traffic flow</a> <a href="/tags/routing-policies/" class="post-tag no-text-decoration" >Routing Policies</a> <a href="/tags/geolocation/" class="post-tag no-text-decoration" >Geolocation</a> <a href="/tags/failover-active-passive/" class="post-tag no-text-decoration" >Failover(Active - Passive)</a> <a href="/tags/privatehosted-zones/" class="post-tag no-text-decoration" >PrivateHosted Zones</a> <a href="/tags/health-checks/" class="post-tag no-text-decoration" >Health Checks</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/AdHuybinh" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/alz.ailove" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=AWS%20Router%2053%20-%20Programmer%20From%20Zero%20To%20Mountaint&url=https%3A%2F%2Fhardworkenglishlearner.github.io%2Fposts%2Faws-router-53%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/in/b%C3%ACnh-nguy%E1%BB%85n-75312a7b/" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/laravel-react-adminlte-dashboard-project-and-todo-example/">Laravel React AdminLTE Dashboard Project and todo example</a><li class="text-truncate lh-lg"> <a href="/posts/aws-white-papers-and-architectures/">AWS White Papers and Architectures</a><li class="text-truncate lh-lg"> <a href="/posts/virtual-private-cloud-vpc-part-2/">Virtual Private Cloud (VPC) part 2</a><li class="text-truncate lh-lg"> <a href="/posts/aws-router-53/">AWS Router 53</a><li class="text-truncate lh-lg"> <a href="/posts/aws-virtual-private-cloud-overview-vpc-part-1/">AWS Virtual Private Cloud Overview (VPC) part 1</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/tags/rails/">rails</a> <a class="post-tag btn btn-outline-primary" href="/tags/api/">api</a> <a class="post-tag btn btn-outline-primary" href="/tags/aws/">AWS</a> <a class="post-tag btn btn-outline-primary" href="/tags/javascript/">javascript</a> <a class="post-tag btn btn-outline-primary" href="/tags/ruby/">ruby</a> <a class="post-tag btn btn-outline-primary" href="/tags/s3/">s3</a> <a class="post-tag btn btn-outline-primary" href="/tags/architecture/">architecture</a> <a class="post-tag btn btn-outline-primary" href="/tags/athena/">athena</a> <a class="post-tag btn btn-outline-primary" href="/tags/aurora/">aurora</a></div></section></div><section id="toc-wrapper" class="ps-0 pe-4"><h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/aws-monitoring-audit-and-performance/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1707152400" data-df="ll" > Feb 6, 2024 </time><h4 class="pt-0 my-2">AWS Monitoring, Audit, and Performance</h4><div class="text-muted"><p> AWS Monitoring, Audit and Performance AWS CloudWatch Metrics Cloudwatch provides metrics for every services in AWS Metric is a variable to monitor (CPUUtilization, NetworkIn…) Metrics belong...</p></div></div></a></article><article class="col"> <a href="/posts/aws-question-and-answer-practice/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1707152400" data-df="ll" > Feb 6, 2024 </time><h4 class="pt-0 my-2">AWS Question and Answer Practice</h4><div class="text-muted"><p> What is ACM? The AWS certtificates manager is a service which allow the creation, managerment and renewable of certificates. It allow deployment certificcatte onto support AWS service...</p></div></div></a></article><article class="col"> <a href="/posts/developing-on-aws/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1707152400" data-df="ll" > Feb 6, 2024 </time><h4 class="pt-0 my-2">Developing on AWS</h4><div class="text-muted"><p> Developing on AWS AWS EC2 Instance Metadata AWS EC2 Instance Medata is powerful but one of the least known features to developers It allows AWS EC2 instances to “learn about themselves” withou...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/extra-solution-architecture-and-aws-services-discussions/" class="btn btn-outline-primary" aria-label="Older" ><p>Extra Solution Architecture and AWS Services discussions</p></a> <a href="/posts/aws-virtual-private-cloud-overview-vpc-part-1/" class="btn btn-outline-primary" aria-label="Newer" ><p>AWS Virtual Private Cloud Overview (VPC) part 1</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://twitter.com/username">Hardwork đẹp trai</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/tags/rails/">rails</a> <a class="post-tag btn btn-outline-primary" href="/tags/api/">api</a> <a class="post-tag btn btn-outline-primary" href="/tags/aws/">AWS</a> <a class="post-tag btn btn-outline-primary" href="/tags/javascript/">javascript</a> <a class="post-tag btn btn-outline-primary" href="/tags/ruby/">ruby</a> <a class="post-tag btn btn-outline-primary" href="/tags/s3/">s3</a> <a class="post-tag btn btn-outline-primary" href="/tags/architecture/">architecture</a> <a class="post-tag btn btn-outline-primary" href="/tags/athena/">athena</a> <a class="post-tag btn btn-outline-primary" href="/tags/aurora/">aurora</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.25.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/assets/js/dist/app.min.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-S57T0PJRJG"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-S57T0PJRJG'); }); </script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
